ВЫБРАТЬ
  МАКСИМУМ(МРМ_ЛогОбращений.Код) КАК Код,
  МРМ_ЛогОбращений.НомерТелефона
ПОМЕСТИТЬ ПоследниеЗаписиЛога
ИЗ
  Справочник.МРМ_ЛогОбращений КАК МРМ_ЛогОбращений
  ГДЕ МРМ_ЛогОбращений.ДатаОбращения >= &ДатаНач

СГРУППИРОВАТЬ ПО
  МРМ_ЛогОбращений.НомерТелефона
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
  МРМ_ЛогОбращений.AppVersion,
  МРМ_ЛогОбращений.НомерТелефона
ПОМЕСТИТЬ Версии
ИЗ
  ПоследниеЗаписиЛога КАК ПоследниеЗаписиЛога
    ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.МРМ_ЛогОбращений КАК МРМ_ЛогОбращений
    ПО ПоследниеЗаписиЛога.Код = МРМ_ЛогОбращений.Код
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
  MRMlogTTL.Код КАК id,
  MRMlogTTL.Дата КАК date,
  MRMlogTTL.PhoneNumber КАК phone,
  MRMlogTTL.logTTL КАК ttl,
  Версии.AppVersion
ИЗ
  Справочник.MRMlogTTL КАК MRMlogTTL
    ВНУТРЕННЕЕ СОЕДИНЕНИЕ Версии КАК Версии
    ПО MRMlogTTL.PhoneNumber = Версии.НомерТелефона
ГДЕ
  //(MRMlogTTL.PhoneNumber = &PhoneNumber1
  //    ИЛИ MRMlogTTL.PhoneNumber = &PhoneNumber2)
  MRMlogTTL.Дата >= &ДатаНач
  И MRMlogTTL.Дата < &ДатаКон
  И НЕ Версии.AppVersion = ""

УПОРЯДОЧИТЬ ПО
  MRMlogTTL.Код
